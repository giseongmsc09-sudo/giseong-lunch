<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í•™êµ ê¸‰ì‹ ìœ„ì ¯</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #ffffff;
            color: #37352f;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            box-sizing: border-box;
        }
        .container {
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        h2 {
            font-size: 1.2rem;
            margin-bottom: 15px;
            color: #eb5757;
            font-weight: 700;
        }
        
        /* ë‚ ì§œ ë„¤ë¹„ê²Œì´ì…˜ ìŠ¤íƒ€ì¼ */
        .date-nav {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        .nav-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            color: #999;
            padding: 5px 10px;
            border-radius: 5px;
            transition: background 0.2s, color 0.2s;
        }
        .nav-btn:hover {
            background-color: #f0f0f0;
            color: #37352f;
        }
        .date {
            font-size: 1rem;
            color: #37352f;
            font-weight: 600;
            min-width: 140px; /* ë‚ ì§œ ë°”ë€Œì–´ë„ í”ë“¤ë¦¼ ë°©ì§€ */
        }

        .menu-list {
            font-size: 1rem;
            line-height: 1.6;
            word-break: keep-all;
            background: #f7f6f3;
            padding: 20px;
            border-radius: 8px;
            min-height: 100px; /* ë¡œë”© ì¤‘ ê¹œë¹¡ì„ ìµœì†Œí™” */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .loading {
            color: #999;
            font-size: 0.9rem;
        }
        
        @media (prefers-color-scheme: dark) {
            body { background-color: #191919; color: #d9d9d9; }
            .menu-list { background: #2f2f2f; }
            .nav-btn { color: #777; }
            .nav-btn:hover { background-color: #3f3f3f; color: #d9d9d9; }
            .date { color: #d9d9d9; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>ğŸ± ì˜¤ëŠ˜ì˜ ê¸‰ì‹</h2>
        
        <div class="date-nav">
            <button class="nav-btn" onclick="changeDate(-1)">&#10094;</button> <div class="date" id="date-display"></div>
            <button class="nav-btn" onclick="changeDate(1)">&#10095;</button> </div>

        <div class="menu-list" id="menu-display">
            <span class="loading">ë©”ë‰´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>
        </div>
    </div>

    <script>
        // 1. ì„¤ì •ê°’ (í•™êµ ì½”ë“œ í™•ì¸ í•„ìˆ˜!)
        const ATPT_OFCDC_SC_CODE = "G10"; // ëŒ€ì „êµìœ¡ì²­
        const SD_SCHUL_CODE = "7430046";  // ëŒ€ì „ê¸°ì„±ì´ˆë“±í•™êµ (ì¤‘í•™êµëŠ” 7430048)
        const API_KEY = "Type=json&pIndex=1&pSize=100";

        // 2. í˜„ì¬ ë‚ ì§œ ìƒíƒœ ê´€ë¦¬
        let currentDate = new Date(); // ì˜¤ëŠ˜ ë‚ ì§œë¡œ ì‹œì‘

        // ì´ˆê¸° ì‹¤í–‰
        updateDisplay();

        // 3. ë‚ ì§œ ë³€ê²½ í•¨ìˆ˜ (ë²„íŠ¼ ëˆ„ë¥´ë©´ ì‹¤í–‰)
        function changeDate(days) {
            // í˜„ì¬ ë‚ ì§œì—ì„œ daysë§Œí¼ ë”í•˜ê±°ë‚˜ ëºŒ
            currentDate.setDate(currentDate.getDate() + days);
            updateDisplay();
        }

        // 4. í™”ë©´ ì—…ë°ì´íŠ¸ ë° ë°ì´í„° ìš”ì²­ í•¨ìˆ˜
        function updateDisplay() {
            const display = document.getElementById('menu-display');
            const dateText = document.getElementById('date-display');
            
            // ë‚ ì§œ í‘œì‹œ ì—…ë°ì´íŠ¸ (ì˜ˆ: 2024ë…„ 05ì›” 20ì¼ (ì›”))
            const year = currentDate.getFullYear();
            const month = String(currentDate.getMonth() + 1).padStart(2, '0');
            const day = String(currentDate.getDate()).padStart(2, '0');
            const dayOfWeek = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '][currentDate.getDay()];
            
            dateText.innerText = `${year}.${month}.${day}(${dayOfWeek})`;
            display.innerHTML = '<span class="loading">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>'; // ë¡œë”© í‘œì‹œ

            // API í˜¸ì¶œìš© ë‚ ì§œ í¬ë§· (YYYYMMDD)
            const apiDate = `${year}${month}${day}`;
            const url = `https://open.neis.go.kr/hub/mealServiceDietInfo?${API_KEY}&ATPT_OFCDC_SC_CODE=${ATPT_OFCDC_SC_CODE}&SD_SCHUL_CODE=${SD_SCHUL_CODE}&MLSV_YMD=${apiDate}`;

            // ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.mealServiceDietInfo) {
                        // ê¸‰ì‹ ì •ë³´ê°€ ìˆëŠ” ê²½ìš°
                        const menuData = data.mealServiceDietInfo[1].row[0].DDISH_NM;
                        
                        // ë°ì´í„° ì •ì œ (ìˆ«ì, ì , ê´„í˜¸ ì œê±° + ì¤„ë°”ê¿ˆ ì²˜ë¦¬)
                        const cleanMenu = menuData
                            .replace(/[0-9.]/g, "") 
                            .replace(/\(\)/g, "")
                            .replace(/<br\/>/g, "<br/>"); // HTML ì¤„ë°”ê¿ˆ ìœ ì§€

                        display.innerHTML = cleanMenu; // innerHTMLë¡œ ë³€ê²½í•˜ì—¬ <br> íƒœê·¸ ì ìš©
                    } else {
                        // ê¸‰ì‹ ì •ë³´ê°€ ì—†ëŠ” ê²½ìš°
                        display.innerText = "ê¸‰ì‹ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.";
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    display.innerText = "ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
                });
        }
    </script>
</body>
</html>
